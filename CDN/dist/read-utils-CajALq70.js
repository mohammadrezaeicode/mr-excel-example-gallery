define(["require","exports","./index-DcKPqAnM"],function(M,N,b){"use strict";function P(s){return/t="s".*?<v/.test(s)}function R(s){const a=/<t.*?>(.*?)<\/t>/,n=s.match(a);return n?n[1]:null}function B(s){const a=/<v.*?>(.*?)<\/v>/,n=s.match(a);return n?n[1]:null}function D(s){const a=/r="(.*?)"/,n=s.match(a);return n?n[1]:null}async function $(s,a=!1,n){let O,A=!1;typeof n=="function"?(O=n,A=!0):O=fetch;let x=[],y=new Map,C={},E=[],k={},V={},T=!1;function j(t,I){let g=0,f=[],i=I.match(/<c[\s\S\n]*?<\/c>/g);if(Array.isArray(i)&&i.forEach(r=>{let h=B(r);P(r)&&h&&(h=E[parseInt(h)]);const p=D(r);let o=b.getColRowBaseOnRefString(p,b.cols);typeof f[o.row]>"u"&&(f[o.row]=[]),f[o.row][o.col]=h,g=Math.max(o.col,g)}),t.indexOf("xl/worksheets/sheet")==0){let r=t.substring(14,t.lastIndexOf("."));y.has(r)&&(r=y.get(r)),k[r]=f,V[r]=g}}return await O(s).then(t=>{if(t==null||t==null)throw"response is null";return A?t:a?t.arrayBuffer():t.blob()}).then(async t=>{const g=(await new Promise((i,r)=>M(["./jszip.min-BoDw5mwd"],i,r)).then(i=>i.jszip_min)).default;let f=0;return await new Promise((i,r)=>{g.loadAsync(t).then(function(h){const p=Object.keys(h.files);f=p.length;let o=new Proxy({counter:0,isNameSet:!1},{set(e,c,l){if(c==="isNameSet")return e.isNameSet=l,!0;if(typeof l!="number")throw"value most be number";return e.counter=l,e.isNameSet&&e.counter===f&&i({data:k,sheetNameObject:C,sheetName:y.entries(),maxLengthOfColumn:V}),!0},get(e,c,l){return c==="isNameSet"?e.isNameSet:e.counter}});p.forEach(function(e){h.files[e].async("string").then(function(c){if(e.indexOf("sharedStrings")>=0){let l=c.match(/<si[\s\S\n]*?<\/si>/g);Array.isArray(l)&&l.forEach(S=>{let m=S.match(/<t[\s\S\n]*?<\/t>/g);if(Array.isArray(m)){let w=m.reduce((u,d)=>u+R(d),"");E.push(w)}}),T=!0,x.length>0&&(x.forEach(S=>{j(S.filename,S.fileData)}),x=[])}e.indexOf("sheet")>=0&&(T?j(e,c):x.push({filename:e,fileData:c})),e.indexOf("workbook")>=0&&(c.replace(/(.*[\n\s\S]*)(<sheets[\n\s\S]*?sheets>)(.*[\n\s\S]*)/,"$2").split("<sheet ").slice(1).forEach((m,w)=>{let u=w+1,d="Sheet "+u;m.indexOf("name=")>=0&&(d=m.replace(/(.*[\n\s\S]*?)name="([^"]*)"(.*[\n\s\S]*)/,"$2")),m.indexOf("sheetId=")>0&&(u=Number(m.replace(/(.*[\n\s\S]*?)sheetId="([^"]*)"(.*[\n\s\S]*)/,"$2")),isNaN(u)&&(u=w+1)),y.set("sheet"+u,d),C["sheet"+u]=d}),o.isNameSet=!0),o.counter++})})})})}).catch(t=>{throw t})}N.extractExcelData=$,Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})});
