<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example 6</title>
    <style>
        body {
            background: #222831;
            color: #F6F6F6;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        button {
            border: none;
            padding: 5px;
            border-radius: 4px;
            background: #F6F6F6;
        }

        .link-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;

            color: #F6F6F6;
        }

        .link-container a {
            color: #F6F6F6;
        }
    </style>
</head>

<body>
    <p>For generate Excel please click the below button</p>
    <button onclick="generateExcel()">Generate Excel</button>
    <div class="link-container">Links: <a href="https://colorhunt.co/palette/f9f7f7dbe2ef3f72af112d4e">Color</a>
        <p> | </p><a
            href="https://github.com/mohammadrezaeicode/mr-excel-page-repo/blob/main/public/img/ex6.PNG?raw=true">Result</a>
    </div>
    <script src="../dist/excel-table.umd.cjs"></script>
    <script>
        const colorPalette = {
            c1: 'DBE2EF',
            c2: '112D4E',
            c4: 'F9F7F7'
        }
        const rowStyle = {
            backgroundColor: colorPalette.c2,
            fontFamily: 'Times New Roman',
            color: colorPalette.c4,
            border: {
                full: {
                    style: 'medium',
                    color: colorPalette.c1
                }
            },
            alignment: {
                horizontal: 'left',
                vertical: 'top'
            }
        }
        const headerStyle = {
            backgroundColor: colorPalette.c4,
            fontFamily: 'Times New Roman',
            color: colorPalette.c2
        }
        const merge = []
        let mergeStart = false
        const data = {
            creator: 'mr',
            styles: {
                Date: {
                    ...rowStyle,
                    format: 'short_date'
                },
                Time: {
                    ...rowStyle,
                    format: 'time'
                },
                Percentage: {
                    ...rowStyle,
                    format: 'percentage'
                },
                Float: {
                    ...rowStyle,
                    format: 'float_2'
                },
                Fraction: {
                    ...rowStyle,
                    format: 'fraction'
                },
                'Long Number Column 1': {
                    ...rowStyle,
                    format: 'dollar_2'
                },
                'Long Number Column 2': {
                    ...rowStyle,
                    format: 'num_sep'
                },
                headerStyle: {
                    ...headerStyle
                }
            },
            sheet: [
                {
                    mergeRowDataCondition(data, key, index, fromHeader) {
                        if (fromHeader) {
                            return false
                        } else {
                            if (mergeStart) {
                                if (merge[key] == data) {
                                    return true
                                } else {
                                    merge[key] = data
                                    return false
                                }
                            } else {
                                mergeStart = true
                                merge[key] = data
                                return true
                            }
                        }
                    },
                    styleCellCondition(data, fullData, rowIndex, colIndex, fromHeader) {
                        if (fromHeader) {
                            return 'headerStyle'
                        } else {
                            if (colIndex == 0) {
                                return 'Date'
                            } else if (colIndex == 1) {
                                return 'Time'
                            } else if (colIndex == 2) {
                                return 'Percentage'
                            } else if (colIndex == 3) {
                                return 'Float'
                            } else if (colIndex == 4) {
                                return 'Fraction'
                            } else if (colIndex == 5) {
                                return 'Long Number Column 1'
                            } else {
                                return 'Long Number Column 2'
                            }
                        }
                    },
                    headers: [
                        { label: 'Date', text: 'Date' },
                        { label: 'Time', text: 'Time' },
                        { label: 'Percentage', text: 'Percentage' },
                        { label: 'Float', text: 'Float' },
                        { label: 'Fraction', text: 'Fraction' },
                        { label: 'Long Number Column 1', text: 'Long Number Column 1', size: 50 },
                        { label: 'Long Number Column 2', text: 'Long Number Column 2', size: 50 }
                    ],
                    data: [
                        {
                            Date: '2023-08-01',
                            Time: '09:00 AM',
                            Percentage: 0.7525,
                            Float: 0.7525,
                            Fraction: '1/4',
                            'Long Number Column 1': 123456789012345,
                            'Long Number Column 2': 987654321098765
                        },
                        {
                            Date: '2023-08-01',
                            Time: '02:30 PM',
                            Percentage: 0.4275,
                            Float: 0.4275,
                            Fraction: '3/8',
                            'Long Number Column 1': 123456789012345,
                            'Long Number Column 2': 876543210987654
                        },
                        {
                            Date: '2023-08-03',
                            Time: '10:45 AM',
                            Percentage: 0.955,
                            Float: 0.955,
                            Fraction: '5/6',
                            'Long Number Column 1': 789012345678901,
                            'Long Number Column 2': 765432109876543
                        },
                        {
                            Date: '2023-08-04',
                            Time: '04:15 PM',
                            Percentage: 0.2875,
                            Float: 0.2875,
                            Fraction: '2/7',
                            'Long Number Column 1': 123450987654321,
                            'Long Number Column 2': 654321098765432
                        },
                        {
                            Date: '2023-08-05',
                            Time: '08:20 AM',
                            Percentage: 0.6,
                            Float: 0.6,
                            Fraction: '4/5',
                            'Long Number Column 1': 543210987654321,
                            'Long Number Column 2': 543210987654321
                        },
                        {
                            Date: '2023-08-05',
                            Time: '08:20 AM',
                            Percentage: 0.6,
                            Float: 0.6,
                            Fraction: '4/5',
                            'Long Number Column 1': 543210987654321,
                            'Long Number Column 2': 543210987654321
                        },
                        {
                            Date: '2023-08-05',
                            Time: '08:20 AM',
                            Percentage: 0.6,
                            Float: 0.61,
                            Fraction: '4/5',
                            'Long Number Column 1': 543210987654321,
                            'Long Number Column 2': 543210987654321
                        }
                    ]
                }
            ]
        }


        function generateExcel() {
            ExcelTable.generateExcel(data);
        }

    </script>
</body>

</html>